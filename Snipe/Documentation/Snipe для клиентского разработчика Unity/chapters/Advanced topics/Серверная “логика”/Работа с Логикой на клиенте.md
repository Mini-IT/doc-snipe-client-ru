#miniit #snipe #snipe-logic 

## LogicManager

Для облегчения работы с серверной логикой имплементирован вспомогательный класс `LogicManager`.

`SnipeApi.LogicManager`.

Рекомендуется всю работу с логикой организовать через `LogicManager`, а не вызывать запросы напрямую.

## Запросы непосредственно через `SnipeApi`

`SnipeApi.Logic.Get` - главный запрос текущего состояния логики. Возвращает список активных деревьев игрока, в каждом из которых указана активная нода и ее переменные. Обычно вызывается в начале сессии и если нужно получить ее текущее состояние. Некоторые ленятся и вызывают его чаще чем нужно, не обрабатывая уведомления от сервера (а в некоторых проектах логика была написана до того как они были реализованы и сейчас что-то менять уже не представляется целесообразным).

Также этот запрос используется для того, чтобы активировать новые деревья и выполнять ноды если у них пустые условия для выполнения. Кроме того, здесь проверяются таймеры и таймауты на выполнение нод.

`SnipeApi.Logic.IncVar` - инкремент клиентской переменной. В нодах логики можно обьявлять переменные, значения которых будет инкрементировать сам клиент до нужного.

`SnipeApi.Logic.Fail` - принудительный провал активной ноды в указанном дереве. Провал должен поддерживаться самой нодой через соответствующий флаг.

`SnipeApi.Logic.Confirm` - подтверждение выполнения ноды. В случае если в ноде логики выставлен флаг, что клиент должен подтверждать ее выполнение, этот запрос необходим, чтобы дерево перешло в другое состояние.

`SnipeApi.Logic.ExitNode` - уведомление сервера о выходе из указанной ноды.

`SnipeApi.Logic.Progress` - уведомление сервера о прогрессе в указанной ноде. Отсылается только при выставлении в ней соответствующего флага.